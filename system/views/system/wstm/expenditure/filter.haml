:ruby
  unit_id = @current_user.unit_id.nil? ? session[:unit_id] : @current_user.unit_id
-if unit_id
  %span#hidden_data.hidden{data: {dialog: "filter", title: t("filter.title_expenditure", data: mat(Wstm::PartnerPerson,'model_name')), model: mat(Wstm::PartnerPerson,'model_name'), oid: "null", related_id: params[:related_id] || 'null'}}
  - unless @current_user.unit_id
    = partial 'wstm/shared/select_unit'
  %form{action: "/sys/#{@path}", method: "get"}
    %table{cellspacing: "0"}
      %tbody
        %tr
          %td
            %span.info= t("filter.intro_expenditure", data: mat(@object,'model_name'))
        %tr
          %td
            %input.select2{type: 'hidden', style: 'width:300px', data: {minlength: 3, model: 'Wstm::PartnerPerson', client_id: 'true', noinit: 'true'}}
            %button.partner-person{type: "button", data: {action: "create", icon: "circle-plus"}}=  t('button.create') + " Persoană fizică!"
      %tfoot
        %tr
          %td.buttonset.ce
            %button.expenditure{type: "button", data: {action: "create", icon: "circle-plus"}}=  t('button.create') + " APP!"
            %button{type: "button", data: {action: "cancel", icon: "circle-close"}}= t('button.cancel')
-else
  %span#hidden_data.hidden{data: {dialog: "filter", title: t("filter.title_expenditure", data: mat(Wstm::PartnerPerson,'model_name')), model: mat(Wstm::PartnerPerson,'model_name'), oid: "null", related_id: params[:related_id] || 'null'}}
  %form{action: "/sys/#{@path}", method: "get"}
    = partial 'wstm/shared/select_unit'
