- if id_intern
  %tbody.inner
    %tr
      - mat(@object,'table_header').each do |label|
        %td.ce= label
    - data = Wstm::DeliveryNote.where(:id.in => dlns).sum_freights_grn; data.sort.each_with_index do |s,i|
      - o = @object.freights.new
      %tr
        %td
          %span.name= s[1][1]
          - input_for o, 'id_date',   {type: 'hidden',nested: 'doc_grn',index: i,value: @object.id_date}
          - input_for o, 'id_stats',  {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][1]}
          - input_for o, 'id_intern', {type: 'hidden',nested: 'doc_grn',index: i,value: 'true'}
          - input_for o, 'freight_id',{type: 'hidden',nested: 'doc_grn',index: i,value: unit.freights.find_by(id_stats: s[1][1]).id}
        %td
          %span.qu{:style => "width:80%"}= "%.2f" % s[1][2]
          - input_for o, 'pu',        {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][2]}
        %td
          %span.val{:style => "width:80%"}= "%.2f" % s[1][3]
          - input_for o, 'qu',        {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][3]}
        %td
          %span.val{:style => "width:80%"}= "%.2f" % s[1][4]
          - input_for o, 'val',       {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][4]}
    %tr.result
      %td.ce.st{:colspan => "3"}= "Total"
      %td
        %span.val{:style => "width:80%"}= "%.2f" % data.values.sum{|r| r[4]}.round(2)
        - input_for @object, 'sum_100',{type: 'hidden',value: data.values.sum{|r| r[4]}.round(2)}
        - input_for @object, 'sum_pay',{type: 'hidden',value: data.values.sum{|r| r[4]}.round(2)}
-else
  %tbody.inner
    %tr
      - mat(@object,'table_header').each do |label|
        %td.ce= label
