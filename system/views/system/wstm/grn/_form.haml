- if id_intern
  %tbody
    %tr
      %td
        %table{cellspacing: "0",style: "width:100%;font-size:12px"}
          %tbody.inner
            %tr
              - mat(@object,'table_header')[0..4].each do |label|
                %td.ce= label
            - data = Wstm::DeliveryNote.where(:id.in => dlns).sum_freights_grn; data.sort.each_with_index do |s,i|
              - o = @object.freights.new
              %tr
                %td
                  %span.stats= s[1][0]
                  - input_for o, 'id_date',   {type: 'hidden',nested: 'doc_grn',index: i,value: @object.id_date}
                  - input_for o, 'id_stats',  {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][1]}
                  - input_for o, 'id_intern', {type: 'hidden',nested: 'doc_grn',index: i,value: 'true'}
                  - input_for o, 'freight_id',{type: 'hidden',nested: 'doc_grn',index: i,value: unit.freights.find_by(id_stats: s[1][1]).id}
                %td
                  %span.um kg
                %td
                  %span.qu= "%.2f" % s[1][2]
                  - input_for o, 'pu',        {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][2]}
                %td
                  %span.val= "%.2f" % s[1][3]
                  - input_for o, 'qu',        {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][3]}
                %td
                  %span.val= "%.2f" % s[1][4]
                  - input_for o, 'val',       {type: 'hidden',nested: 'doc_grn',index: i,value: s[1][4]}
            %tr.total
              %td.ce.st{:colspan => "4"}= "Total"
              %td
                %span.val= "%.2f" % data.values.sum{|r| r[4]}.round(2)
                - input_for @object, 'sum_100',{type: 'hidden',value: data.values.sum{|r| r[4]}.round(2)}
                - input_for @object, 'sum_out',{type: 'hidden',value: data.values.sum{|r| r[4]}.round(2)}
-else
  %tbody{id: 'tabs-freights',data: {title: mat(@object,'tabs_freights')}}
    %tr
      %td
        %table{cellspacing: "0",style: "width:100%;font-size:12px"}
          %tbody.inner
            %tr
              - mat(@object,'table_header').each do |label|
                %td.ce= label
            - for i in 0..4 do; o = @object.freights.new
              %tr.freight
                %td.select-freight
                  %select.wstm.freight
                    %option{value: 'null',data: {id_stats: 'null',um: 'kg',pu: 0,p03: 'null'}} Selectare material
                    - freights.each do |f|
                      %option{value: f[0], data: f[2]}= f[1]
                  - input_for   o, 'id_date',   {type: 'hidden',nested: 'doc_grn',value: 'strip',index: i}
                  - input_for   o, 'id_stats',  {type: 'hidden',nested: 'doc_grn',value: 'strip',index: i}
                  - input_for   o, 'freight_id',{type: 'hidden',nested: 'doc_grn',value: 'strip',index: i}
                - td_input_for  o, 'um',        {style: ' um',nested: 'doc_grn',index: i}
                - td_input_for  o, 'pu',        {style: ' pu',nested: 'doc_grn',index: i}
                - td_input_for  o, 'qu',        {style: ' qu',nested: 'doc_grn',index: i}
                %td
                  %span.val 0.00
                  - input_for   o, 'val',       {type: 'hidden',nested: 'doc_grn',index: i}
                %td
                  %span.p03 0.00
                %td.action-1
                  %span.icon-remove-sign{title: t('button.delete')}
            %tr.total
              %td.ce.st{colspan: '4'}
                %span Total
              %td
                %span.val 0.00
                - input_for @object, 'sum_100',   {type: 'hidden'}
              %td
                %span.p03 0.00
                - input_for @object, 'sum_003',   {type: 'hidden'}
              %td
                %span.out
                &nbsp;
                - input_for @object, 'sum_out',   {type: 'hidden'}
  %tbody{id: 'tabs-payments',data: {title: mat(@object,'tabs_payments')}}
    %tr.dn
      %td
        %span.info= t('intro.create.desk_grn.pyms_no')
    %tr.inv
      %td
        %span.info= t('intro.create.desk_grn.pyms_ok')
    %tr.inv
      %td
        %span.stats= mat(@object,'deadl')
        %input.ui-state-default.ce{name: '[wstm/grn][deadl]',value: (Date.today + 30.days).to_s}
    %tr.inv.pyms
      %td
        %input{type: 'hidden',name: '[wstm/grn][pyms][id_date]'}
        %input{type: 'hidden',name: '[wstm/grn][pyms][id_intern]',value: 'false'}
        %input.ui-state-default.width-250{name: '[wstm/grn][pyms][text]',placeholder: mat(@object,'pyms_text')}
        %input.ui-state-default.ce{name: '[wstm/grn][pyms][val]',placeholder: mat(@object,'pyms_val')}
