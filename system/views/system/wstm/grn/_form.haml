- if id_intern
  %tbody
    %tr
      %td
        %table.w-100pr
          %tbody.inner
            %tr
              - mat(@object,'table_header')[0..4].each do |label|
                %td
                  %span= label
            - data = Wstm::DeliveryNote.where(:id.in => dlns).sum_freights_grn; data.sort.each_with_index do |s,i|
              - o = @object.freights.new
              %tr
                %td
                  %span.stats= s[1][0]
                  - input_for   o, 'id_date',   {guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'id_date'},type: 'hidden',value: @object.id_date.to_s}}
                  - input_for   o, 'id_stats',  {guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'id_stats'},type: 'hidden',value: s[1][1]}}
                  - input_for   o, 'id_intern', {guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'id_intern'},type: 'hidden',value: id_intern}}
                  - input_for   o, 'freight_id',{guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'freight_id'},type: 'hidden',value: unit.freights.find_by(id_stats: s[1][1]).id}}
                  - input_for   o, 'pu',        {guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'pu'},type: 'hidden',value: s[1][2]}}
                  - input_for   o, 'qu',        {guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'qu'},type: 'hidden',value: s[1][3]}}
                  - input_for   o, 'val',       {guess: {nested: 'doc_grn',index: i},tag: {data: {val: 'val'},type: 'hidden',value: s[1][4]}}
                - td_value_for  o, 'um',        {tag: {class: 'strip',value: 'kg'},td: {class: 'ta-ce'}}
                - td_value_for  o, 'pu',        {tag: {class: 'strip',value: s[1][2]},td: {class: 'ta-ri'}}
                - td_value_for  o, 'qu',        {tag: {class: 'strip',value: s[1][3]},td: {class: 'ta-ri'}}
                - td_value_for  o, 'val',       {tag: {class: 'strip',value: s[1][4]},td: {class: 'ta-ri'}}
            %tr.total
              %td{:colspan => "4"}= "Total"
              %td
                %span.val= "%.2f" % data.values.sum{|r| r[4]}.round(2)
                - input_for @object, 'sum_100',{tag: {type: 'hidden',value: data.values.sum{|r| r[4]}.round(2)}}
                - input_for @object, 'sum_out',{tag: {type: 'hidden',value: data.values.sum{|r| r[4]}.round(2)}}
-else
  %tbody{id: 'tabs-freights',data: {title: mat(@object,'tabs_freights')}}
    %tr
      %td
        %table.w-100pr
          %tbody.inner
            %tr
              - mat(@object,'table_header').each do |label|
                %td
                  %span= label
            - for i in 0..4 do; o = @object.freights.new
              %tr.freight
                %td.select-freight
                  %select.wstm.freight
                    %option{value: 'null',data: {id_stats: 'null',um: 'kg',pu: 0,p03: 'null'}} Selectare material
                    - freights.each do |f|
                      %option{value: f[0], data: f[2]}= f[1]
                  - input_for   o, 'id_date',   {type: 'hidden',nested: 'doc_grn',value: 'strip',index: i}
                  - input_for   o, 'id_stats',  {type: 'hidden',nested: 'doc_grn',value: 'strip',index: i}
                  - input_for   o, 'freight_id',{type: 'hidden',nested: 'doc_grn',value: 'strip',index: i}
                %td.ta-ce.w-4rem
                  - input_for  o, 'um',        {disabled: true,style: 'um ta-ce w-2rem',nested: 'doc_grn',index: i}
                %td.ta-ce.w-6rem
                  - input_for  o, 'pu',        {style: 'pu ta-ri w-4rem',nested: 'doc_grn',index: i}
                %td.ta-ce.w-8rem
                  - input_for  o, 'qu',        {style: 'qu ta-ri w-6rem',nested: 'doc_grn',index: i}
                %td.ta-ri.w-8rem
                  %span.val 0.00
                  - input_for   o, 'val',       {type: 'hidden',nested: 'doc_grn',index: i}
                %td.ta-ri.w-6rem
                  %span.p03 0.00
                %td.ta-ce
                  %span.fa.fa-minus-circle.red{title: t('button.delete')}
            %tr.total
              %td{colspan: '4'}
                %span Total
              %td
                %span.val 0.00
                - input_for @object, 'sum_100',   {type: 'hidden'}
              %td
                %span.p03 0.00
                - input_for @object, 'sum_003',   {type: 'hidden'}
                - input_for @object, 'sum_out',   {type: 'hidden'}
              %td
                %span.fa.fa-plus-circle{title: t('button.new_row')}
  %tbody{id: 'tabs-payments',data: {title: mat(@object,'tabs_payments')}}
    %tr.dn
      %td
        %detail.detail
          %i.fa.fa-info-circle.fa-lg.blue
          = t('intro.create.desk_grn.pyms_no')
    %tr.inv.pdb-05
      %td
        %detail.detail
          %i.fa.fa-info-circle.fa-lg.blue
          = t('intro.create.desk_grn.pyms_ok')
    %tr.inv.pdb-05
      %td
        %span= mat(@object,'deadl')
        %input.ui-state-default.ta-ce{name: '[wstm/grn][deadl]',value: (Date.today + 30.days).to_s}
    %tr.inv.pyms
      %td
        %input{type: 'hidden',name: '[wstm/grn][pyms][id_date]'}
        %input{type: 'hidden',name: '[wstm/grn][pyms][id_intern]',value: 'false'}
        %input.ui-state-default.w-25rem{name: '[wstm/grn][pyms][text]',placeholder: mat(@object,'pyms_text')}
        %input.ui-state-default.ta-ce{name: '[wstm/grn][pyms][val]',placeholder: mat(@object,'pyms_val')}
