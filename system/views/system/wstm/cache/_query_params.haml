:ruby
  firm, colspan = locals[:firm], locals[:colspan]
  today = Date.today;
  y   = params[:p_y].nil? ? today.year  : params[:p_y].to_i
  m   = params[:p_m].nil? ? today.month : params[:p_m].to_i
  uid = @current_user.unit_id ? @current_user.unit_id : params[:uid] == 'null' ? nil : params[:uid]

%tr.pdb-05
  %td{colspan: colspan}
    %select.param{name: 'p_y'}
      - (2014..today.year).each do |year|
        %option{value: year, selected: y == year}= year
    %select.param{name: 'p_m'}
      - t('month')[1..12].each_with_index do |month,i|
        %option{value: i + 1, selected: m == i + 1}= month
    - if firm
      - if @current_user.unit_id
        %span= l(Date.today,format: :trst)
      - else
        %select.param{name: 'uid'}
          %option{value: 'null'} Toate unităţile
          - firm.units.asc(:slug).each do |pos|
            %option{value: pos.id, selected: uid.to_s == pos.id.to_s}= pos.name[1]
