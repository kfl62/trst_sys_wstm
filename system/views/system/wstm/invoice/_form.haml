%tbody{id: 'tabs-freights',data: {title: mat(@object,'tabs_freights')}}
  %tr
    %td
      %table{:style => "width:100%;font-size:1.1em"}
        %tbody.inner
          %tr
            - mat(@object,'table_header').each do |label|
              %td.ce= label
          - data = Wstm::DeliveryNote.where(:id.in => dlns).sum_freights_inv; data.sort.each_with_index do |s,i|
            - o = @object.freights.new
            %tr.freight
              %td
                %span.stats= s[1][0]
                - input_for o, 'name',      {type: 'hidden',nested: 'doc_inv',index: i,value: s[1][0]}
                - input_for o, 'um',        {type: 'hidden',nested: 'doc_inv',index: i,value: 'kg'}
                - input_for o, 'id_stats',  {type: 'hidden',nested: 'doc_inv',index: i,value: s[1][1]}
              %td
                %span.um kg
              %td
                %span.qu= "%.2f" % s[1][2]
                - input_for o,  'qu',     {type: 'hidden',nested: 'doc_inv',index: i,value: s[1][2]}
              %td
                %span.val= "%.2f" % s[1][3]
              %td
                - if s[1][4] == 0.0
                  - input_for o,  'pu',     {style: 'qu',nested: 'doc_inv',index: i,value: "%.4f" % s[1][4]}
                -else
                  %span.val= "%.4f" % s[1][4]
                  - input_for o,  'pu',     {type: 'hidden',nested: 'doc_inv',index: i,value: s[1][4]}
              %td
                %span.val.val_invoice= "%.2f" % s[1][5]
          %tr.total
            %td.ce.st{:colspan => "2"}= "Total"
            %td
              %span.val= "%.2f" % data.values.sum{|r| r[2]}
            %td
              %span.val= "%.2f" % data.values.sum{|r| r[3]}
            %td
              %span
            %td
              %span.val.sum_100= "%.2f" % data.values.sum{|r| r[5]}
              - input_for @object, 'sum_100', {type: 'hidden',value: data.values.sum{|r| r[5]}}
  %tr
    %td
%tbody{id: 'tabs-payments',data: {title: mat(@object,'tabs_payments')}}
  %tr
    %td
      - label_for @object, 'payed'
      %input.before-yes{type: 'radio',name: "[#{@path}][payed]",checked:  @object.payed,value: 'true'}
      %input.before-no{type: 'radio', name: "[#{@path}][payed]",checked: !@object.payed,value: 'false'}
      %span.stats= mat(@object,'deadl')
      - input_for @object, 'deadl', {type: 'tel',style: 'ui-state-default ce',value: (Date.today + 30.days).to_s}
  - o = @object.pyms.new
  %tr
    %td
      - input_for o, 'id_date',     {type: 'tel',   nested: 'doc_inv',index: 0,value: 'strip',placeholder: Date.today.to_s,style: 'ui-state-default ce'}
      - input_for o, 'text',        {type: 'tel',   nested: 'doc_inv',index: 0,value: 'strip',placeholder: mat(@object,'pyms_text')}
      - input_for o, 'val',         {type: 'tel',   nested: 'doc_inv',index: 0,value: 'strip',placeholder: mat(@object,'pyms_val'),style: 'ui-state-default ce'}
      - input_for o, 'id_intern',   {type: 'hidden',nested: 'doc_inv',index: 0,value: 'true'}

